---
import { Image } from "astro:assets";
import myProfile from "../../assets/pp.jpg";
---

<div class="mx-auto md:m-0">
	<Image id="profile" loading={'eager'} quality={'high'} src={myProfile} alt="profile pic" class="profile object-cover object-top grayscale duration-[2000ms] aspect-square transition-all border-[3px] border-textColor dark:border-gray-400" />
</div>

<style>
	.profile {
		border-radius: 60% 40% 30% 70%/60% 30% 70% 40%;
	}

	.profile-animate {
		animation: morph 5s ease-in-out infinite;
		/* animation-fill-mode: forwards; */
	}

	@keyframes morph {
		0% {
			border-radius: 60% 40% 30% 70%/60% 30% 70% 40%;
			/* border-radius: var(--first-border-radius); */
		}

		50% {
			border-radius: 30% 60% 70% 40%/50% 60% 30% 60%;
			/* border-radius: var(--second-border-radius); */
		}

		100% {
			border-radius: 60% 40% 30% 70%/60% 30% 70% 40%;
			/* border-radius: var(--first-border-radius); */
		}
	}
</style>
<script>
	import { wait } from "@/utils/helpers";

	const profilePic = document.getElementById("profile");

	let firstTime = true;
	if (profilePic) {
		document.documentElement.addEventListener("show-stars", async () => {
			// wait for two second that border radius get back to its first postions
			// two second because when we add animation class suddenly it does not jump back
			// - to keyframe 0 position and does it smoothly
			// first time is for when we add animation for the first time it does not need
			// to wait for two second
			if (!profilePic.classList.contains("profile-animate") && !firstTime) {
				profilePic.style.removeProperty("border-radius");
				await wait(2);
			}
			firstTime = false;
			const borderRadius = window.getComputedStyle(profilePic).borderRadius;
			profilePic.style.borderRadius = borderRadius;
			profilePic.classList.toggle("profile-animate");
		});
	}
</script>
